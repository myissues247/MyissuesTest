!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{"o/Q4":function(t,i,s){"use strict";s.r(i),s.d(i,"MainStepsModule",(function(){return G}));var a=s("ofXK"),o=s("tyNb"),r=s("XNiG"),c=s("1G5W"),l=s("fXoL"),u=s("E+NS"),d=s("5dVO"),b=s("ndxW"),h=s("3Pt+"),p=s("QIUk"),v=s("7zfz"),g=s("dgC2"),f=["next"];function m(e,t){1&e&&(l.Qb(0,"div",42),l.Qb(1,"span",43),l.Jc(2,"Please enter a valid advertisement title."),l.Pb(),l.Pb())}function y(e,t){1&e&&(l.Qb(0,"div",42),l.Qb(1,"span",43),l.Jc(2,"Please enter a valid name. (Only alphabets)"),l.Pb(),l.Pb())}function P(e,t){1&e&&(l.Qb(0,"div",42),l.Qb(1,"span",43),l.Jc(2,"Please select a household member"),l.Pb(),l.Pb())}function Q(e,t){1&e&&(l.Qb(0,"div",42),l.Qb(1,"span",43),l.Jc(2,"Please enter a valid tag line."),l.Pb(),l.Pb())}function C(e,t){1&e&&(l.Qb(0,"div",42),l.Qb(1,"span",43),l.Jc(2,"Please enter a valid description."),l.Pb(),l.Pb())}var M=function(){return{height:"320px","font-size":"16px"}};function w(e,t){if(1&e){var n=l.Rb();l.Qb(0,"div",11),l.Qb(1,"label",12),l.Jc(2,"Advertisement Title"),l.Pb(),l.Qb(3,"p",13),l.Jc(4),l.Pb(),l.Qb(5,"div",14),l.Qb(6,"input",15,16),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().adContent.adTitle=e})),l.Pb(),l.Lb(8,"img",17),l.Pb(),l.Hc(9,m,3,0,"div",18),l.Pb(),l.Qb(10,"div",19),l.Qb(11,"div",20),l.Qb(12,"label",21),l.Jc(13,"Name"),l.Pb(),l.Qb(14,"span",22),l.Jc(15,"First Name Only"),l.Pb(),l.Qb(16,"p",13),l.Jc(17),l.Pb(),l.Qb(18,"input",23,24),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().adContent.firstName=e})),l.Pb(),l.Hc(20,y,3,0,"div",18),l.Pb(),l.Qb(21,"div",25),l.Qb(22,"label",26),l.Jc(23,"Household Members"),l.Pb(),l.Qb(24,"select",27,28),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().adContent.householdMember=e})),l.Qb(26,"option",29),l.Jc(27,"Select"),l.Pb(),l.Qb(28,"option",30),l.Jc(29,"Single Parent 1"),l.Pb(),l.Qb(30,"option",31),l.Jc(31,"Single Parent 2"),l.Pb(),l.Qb(32,"option",32),l.Jc(33,"Single Parent 3"),l.Pb(),l.Qb(34,"option",33),l.Jc(35,"Seniors 1"),l.Pb(),l.Qb(36,"option",34),l.Jc(37,"Seniors 2"),l.Pb(),l.Qb(38,"option",35),l.Jc(39,"Seniors 3"),l.Pb(),l.Pb(),l.Hc(40,P,3,0,"div",18),l.Pb(),l.Pb(),l.Qb(41,"div",36),l.Qb(42,"label",37),l.Jc(43,"Tag Line"),l.Pb(),l.Qb(44,"input",38,39),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().adContent.tagline=e})),l.Pb(),l.Hc(46,Q,3,0,"div",18),l.Pb(),l.Qb(47,"div",11),l.Qb(48,"label",40),l.Jc(49,"Description"),l.Pb(),l.Qb(50,"p-editor",41),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().adContent.description=e})),l.Pb(),l.Hc(51,C,3,0,"div",18),l.Pb()}if(2&e){var i=l.wc(7),s=l.wc(19),a=l.wc(25),o=l.wc(45),r=l.bc(),c=l.wc(1);l.yb(4),l.Lc("",60-((null==r.adContent.adTitle?null:r.adContent.adTitle.length)||0)," characters left"),l.yb(2),l.ic("ngModel",r.adContent.adTitle),l.yb(3),l.ic("ngIf",c.submitted&&i.invalid),l.yb(8),l.Lc("",25-((null==r.adContent.firstName?null:r.adContent.firstName.length)||0)," charaters left"),l.yb(1),l.ic("ngModel",r.adContent.firstName),l.yb(2),l.ic("ngIf",c.submitted&&s.invalid),l.yb(4),l.ic("ngModel",r.adContent.householdMember),l.yb(16),l.ic("ngIf",c.submitted&&a.invalid),l.yb(4),l.ic("ngModel",r.adContent.tagline),l.yb(2),l.ic("ngIf",c.submitted&&o.invalid),l.yb(4),l.Fc(l.mc(14,M)),l.ic("ngModel",r.adContent.description),l.yb(1),l.ic("ngIf",c.submitted&&!r.adContent.description)}}var k,x,_,O=((k=function(){function t(n,i,s,a,o,c){e(this,t),this.ren=n,this.ps=i,this.router=s,this.loader=a,this.ar=o,this.ss=c,this.submitting=!1,this.saved=!1,this.unsub$=new r.a,this.adContent={adTitle:"",firstName:"",description:"",householdMember:"",tagline:""}}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.ps.newPage(3),this.getUserSession(),this.ps.AdObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.ad=t,e.ad._id||(e.ps.newMessage("info","Ad Not Initialized","Please start an ad by selecting category"),e.router.navigate(["../select-location"],{relativeTo:e.ar})),e.presetData(t)}))}},{key:"buttonEventFromParent",value:function(){var e=this;this.ps.checkSubmition().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){var n,i;console.log("hello"+t),console.log(e.submitButtonRef),"save-next"==t?null===(i=null===(n=e.submitButtonRef)||void 0===n?void 0:n.nativeElement)||void 0===i||i.click():"prev"==t?e.prevPage():e.nextNoSave()}))}},{key:"getUserSession",value:function(){var e=this;this.ss.getUserSessionObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.session=t}))}},{key:"presetData",value:function(e){var t=e.adTitle,n=e.firstName,i=e.description,s=e.householdMember,a=e.tagline;this.adContent={adTitle:t,firstName:n,description:i,householdMember:s,tagline:a},t&&s&&i&&n&&a&&(this.saved=!0)}},{key:"ngAfterViewInit",value:function(){var e=document.getElementsByClassName("ql-formats"),t=this.ren.parentNode(e[0]);this.ren.removeChild(t,e[0]),this.ren.removeChild(t,e[2]),this.ren.removeChild(t,e[4]),this.buttonEventFromParent()}},{key:"save_ad_content",value:function(){var e=this;return new Promise((function(t,n){e.ps.save_ad_content(e.adContent).pipe(Object(c.a)(e.unsub$)).subscribe((function(i){return i.status?(e.ps.newMessage("success","Ad Content Saved","The content was saved!"),e.ps.NewAdData(i.data),e.stopload(),t(!0)):(e.ps.newMessage("error","Content Save Failed",i.message),n(!1))}),(function(t){return e.handle_error(t),n(!1)}))}))}},{key:"prevPage",value:function(){this.router.navigate(["../../select-location"],{relativeTo:this.ar})}},{key:"nextPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"../../contact-details/step1";if("INVALID"==e.status)return this.ps.newMessage("error","Invalid Input","Please fill the form with valid inputs");this.load(),this.saved?this.checkAndHandleUnsavedChanges(t):this.saveAndMove(t)}},{key:"nextNoSave",value:function(){this.router.navigate(["../../contact-details/step1"],{relativeTo:this.ar})}},{key:"checkAndHandleUnsavedChanges",value:function(e){var t=this;this.checkUnsavedChanges()?this.handleUnsavedChanges().then((function(){t.stopload(),t.saveAndMove(e)})).catch((function(){return t.stopload()})):(this.stopload(),this.router.navigate([e],{relativeTo:this.ar}))}},{key:"checkUnsavedChanges",value:function(){return this.ad.firstName!=this.adContent.firstName||this.ad.description!=this.adContent.description||this.ad.householdMember!=this.adContent.householdMember||this.ad.adTitle!=this.adContent.adTitle||this.ad.tagline!=this.adContent.tagline}},{key:"handleUnsavedChanges",value:function(){return new Promise((function(e,t){e(!0)}))}},{key:"saveAndMove",value:function(e){var t=this;this.save_ad_content().then((function(){t.stopload(),t.router.navigate([e],{relativeTo:t.ar})})).catch((function(){t.stopload()}))}},{key:"handle_error",value:function(e){e.error instanceof ErrorEvent?this.ps.newMessage("error","Error occured","sorry couldn't connect to the URL"):this.ps.newMessage("error","Error occured",e.error.message)}},{key:"load",value:function(){this.submitting=!0,this.loader.start()}},{key:"stopload",value:function(){this.submitting=!1,this.loader.stop()}},{key:"ngOnDestroy",value:function(){this.unsub$.next(!0),this.unsub$.complete()}}]),t}()).\u0275fac=function(e){return new(e||k)(l.Kb(l.D),l.Kb(u.a),l.Kb(o.f),l.Kb(d.a),l.Kb(o.a),l.Kb(b.a))},k.\u0275cmp=l.Eb({type:k,selectors:[["app-ad-content"]],viewQuery:function(e,t){var n;1&e&&l.Qc(f,!0),2&e&&l.vc(n=l.Yb())&&(t.submitButtonRef=n.first)},decls:19,vars:2,consts:[[1,"input-container",3,"ngSubmit"],["sadForm","ngForm"],[1,"stepsdemo-content"],["pTemplate","content"],[1,"d-footer","c-footer",2,"display","none"],["type","button",1,"btn","btn-prev",3,"click"],[1,"fa","fa-angle-left"],[1,"btn","btn-next",3,"click"],["type","submit","name","submit",1,"btn","btn-next"],["next",""],[1,"fa","fa-angle-right"],[1,"form-group"],["for","adTitle"],[1,"left-char"],[1,"form-icon","right-icon"],["type","text","name","adTitle","placeholder","","maxlength","60","required","","ngModel","",1,"form-control",3,"ngModel","ngModelChange"],["adTitle","ngModel"],["src","assets/images/emoji-icon.png","alt","Icons"],["class","errors",4,"ngIf"],[1,"group"],["id","name-input",1,"form-group","flex-2"],["for","name"],[1,"badge"],["type","text","autocapitalize","words","name","name","placeholder","","maxlength","25","pattern","[a-zA-Z ]+","required","","ngModel","",1,"form-control","capitalize",3,"ngModel","ngModelChange"],["name","ngModel"],["id","gender-input",1,"form-group","mx-md-3","flex-1"],["for","householdMember"],["name","householdMember","id","selecthouseHoldMember","ngModel","","required","",1,"form-control",3,"ngModel","ngModelChange"],["householdMember","ngModel"],["value","","disabled",""],["value","single parent 1"],["value","single parent 2"],["value","single parent 3"],["value","seniors 1"],["value","seniors 2"],["value","seniors 3"],["id","name-input",1,"form-group"],["for","tag"],["type","text","name","tag","placeholder","Describe your best attribute in short and catchy way","required","","ngModel","",1,"form-control",3,"ngModel","ngModelChange"],["tag","ngModel"],["for","description"],["name","description","ngModel","",3,"ngModel","ngModelChange"],[1,"errors"],[1,"error"]],template:function(e,t){if(1&e){var n=l.Rb();l.Qb(0,"form",0,1),l.Xb("ngSubmit",(function(){l.zc(n);var e=l.wc(1);return t.nextPage(e)})),l.Qb(2,"section",2),l.Qb(3,"p-card"),l.Hc(4,w,52,15,"ng-template",3),l.Pb(),l.Pb(),l.Qb(5,"div",4),l.Qb(6,"ul"),l.Qb(7,"li"),l.Qb(8,"button",5),l.Xb("click",(function(){return t.prevPage()})),l.Lb(9,"i",6),l.Jc(10,"Previous step"),l.Pb(),l.Pb(),l.Qb(11,"li"),l.Qb(12,"button",7),l.Xb("click",(function(){l.zc(n);var e=l.wc(1);return t.nextPage(e,"/"+t.session.type)})),l.Jc(13," Save & Exit "),l.Pb(),l.Pb(),l.Qb(14,"li"),l.Qb(15,"button",8,9),l.Jc(17," Next step "),l.Lb(18,"i",10),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb()}2&e&&(l.yb(2),l.Cb("submitting",t.submitting))},directives:[h.A,h.o,h.p,p.a,v.j,h.c,h.k,h.w,h.n,h.q,a.n,h.t,h.x,h.r,h.z,g.a],styles:['.page-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between}form[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between}.form-group[_ngcontent-%COMP%]{margin-left:5px;margin-right:5px}.submitting[_ngcontent-%COMP%]{position:relative}.submitting[_ngcontent-%COMP%]:before{content:" ";width:100%;height:100%;background:hsla(0,0%,100%,.6);position:absolute;top:0;left:0;z-index:1111}.error[_ngcontent-%COMP%]{color:red}[_nghost-%COMP%]     .p-card{box-shadow:0 0 3px rgb(0 0 0/30%)}label[_ngcontent-%COMP%]{color:#6b9bb2;font-weight:700;font-size:24px!important}.form-control[_ngcontent-%COMP%]{height:50px!important}@media screen and (max-width:550px){.group[_ngcontent-%COMP%]   #name-input[_ngcontent-%COMP%]{min-width:100%;margin-right:0}}']}),k),S=s("3LrJ"),N=((_=function(){function t(n,i,s,a,o){e(this,t),this.router=n,this.ss=i,this.ar=s,this.ps=a,this.loader=o,this.submitting=!1,this.unsub$=new r.a}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.ps.newPage(6),this.buttonEventFromParent(),this.ps.AdObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.ad=t,e.ad._id||(alert("ad is not initialized"),e.router.navigate(["../select-location"],{relativeTo:e.ar}))}))}},{key:"buttonEventFromParent",value:function(){var e=this;this.ps.checkSubmition().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){"save-next"==t?e.nextPage():"prev"==t?e.prevPage():e.nextNoSave()}))}},{key:"nextPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"../finalize";this.router.navigate([e],{relativeTo:this.ar})}},{key:"nextNoSave",value:function(){this.router.navigate(["../finalize"],{relativeTo:this.ar})}},{key:"prevPage",value:function(){this.router.navigate(["../photos"],{relativeTo:this.ar})}},{key:"errorHandle",value:function(e){var t;e.error instanceof ErrorEvent?this.ps.newMessage("error","Error Occured","sorry some error occured"):this.ps.newMessage("error","Error Occured",null===(t=e.error)||void 0===t?void 0:t.message),this.stopload()}},{key:"load",value:function(){this.submitting=!0,this.loader.start()}},{key:"stopload",value:function(){this.submitting=!1,this.loader.stop()}},{key:"ngOnDestroy",value:function(){this.unsub$.next(),this.unsub$.complete()}}]),t}()).\u0275fac=function(e){return new(e||_)(l.Kb(o.f),l.Kb(b.a),l.Kb(o.a),l.Kb(u.a),l.Kb(d.a))},_.\u0275cmp=l.Eb({type:_,selectors:[["app-choose-grocery"]],decls:29,vars:8,consts:[[1,"d-header","cat-header"],[1,"container"],[1,"row"],[1,"col-sm-12"],[1,"panl-list-sec","upgrade-list"],["alt","home-pic",3,"src"],[1,"cancer-des"],[1,"d-footer","c-footer",2,"display","none"],["type","button",1,"btn","btn-prev"],[1,"fa","fa-angle-left"],["type","button",1,"btn","btn-next",3,"click"],[1,"fa","fa-angle-right"]],template:function(e,t){1&e&&(l.Qb(0,"section",0),l.Qb(1,"div",1),l.Qb(2,"div",2),l.Qb(3,"div",3),l.Qb(4,"form"),l.Qb(5,"div",4),l.Qb(6,"ul"),l.Qb(7,"li"),l.Lb(8,"img",5),l.cc(9,"server"),l.Pb(),l.Qb(10,"li"),l.Qb(11,"div",6),l.Jc(12," Foodbank "),l.Qb(13,"p"),l.Jc(14),l.cc(15,"date"),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(16,"div",7),l.Qb(17,"ul"),l.Qb(18,"li"),l.Qb(19,"button",8),l.Lb(20,"i",9),l.Jc(21," Previous step "),l.Pb(),l.Pb(),l.Qb(22,"li"),l.Qb(23,"button",10),l.Xb("click",(function(){return t.nextPage("/"+t.session.type)})),l.Jc(24," Save & Exit "),l.Pb(),l.Pb(),l.Qb(25,"li"),l.Qb(26,"button",10),l.Xb("click",(function(){return t.nextPage()})),l.Jc(27," Next step "),l.Lb(28,"i",11),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb()),2&e&&(l.yb(8),l.jc("src",l.dc(9,3,t.ad.identityImages[0])||"assets/images/no-image.jpg",l.Cc),l.yb(6),l.Mc(" Start date ",l.ec(15,5,t.ad.createdOn,"medium")," - ",t.ad.city," "))},directives:[h.A,h.o,h.p],pipes:[S.a,a.d],styles:[""]}),_),J=((x=function(){function t(){e(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(e){return new(e||x)},x.\u0275cmp=l.Eb({type:x,selectors:[["app-main-steps"]],features:[l.xb([v.h])],decls:1,vars:0,template:function(e,t){1&e&&l.Lb(0,"router-outlet")},directives:[o.k],styles:[""]}),x),A=s("DPk/");function T(e,t){if(1&e){var n=l.Rb();l.Qb(0,"label",10),l.Qb(1,"input",11),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().selectedCountry=e}))("click",(function(){l.zc(n);var e=t.$implicit;return l.bc().change_country(e._id)})),l.Pb(),l.Qb(2,"span"),l.Jc(3),l.Pb(),l.Pb()}if(2&e){var i=t.$implicit,s=l.bc();l.yb(1),l.jc("value",i._id),l.ic("ngModel",s.selectedCountry),l.yb(2),l.Kc(i.countryName)}}function j(e,t){if(1&e){var n=l.Rb();l.Qb(0,"label",10),l.Qb(1,"input",12),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().selectedState=e}))("click",(function(){l.zc(n);var e=t.$implicit;return l.bc().change_state(e.stateName)})),l.Pb(),l.Qb(2,"span"),l.Jc(3),l.Pb(),l.Pb()}if(2&e){var i=t.$implicit,s=l.bc();l.yb(1),l.jc("value",i.stateName),l.ic("ngModel",s.selectedState),l.yb(2),l.Kc(i.stateName)}}function $(e,t){if(1&e){var n=l.Rb();l.Qb(0,"label",10),l.Qb(1,"input",13),l.Xb("ngModelChange",(function(e){return l.zc(n),l.bc().selectedCity=e}))("click",(function(){l.zc(n);var e=t.$implicit;return l.bc().change_city(e.cityName)})),l.Pb(),l.Qb(2,"span"),l.Jc(3),l.Pb(),l.Pb()}if(2&e){var i=t.$implicit,s=l.bc();l.yb(1),l.jc("value",i.cityName),l.ic("ngModel",s.selectedCity),l.yb(2),l.Kc(i.cityName)}}function E(e,t){1&e&&l.Lb(0,"div",14)}var z,I,F,K,L=((I=function(){function t(n,i,s,a,o,c){e(this,t),this.ds=n,this.ps=i,this.router=s,this.loader=a,this.ar=o,this.ss=c,this.submitting=!1,this.loading=!1,this.saved=!1,this.unsub$=new r.a,this.cities=[],this.states=[],this.countries=[],this.selectedCountry="",this.selectedState="",this.selectedCity=""}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.ps.newPage(2),this.buttonEventFromParent(),this.ps.AdObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.ad=t})),this.check_session(),this.check_action(),this.get_country().then((function(){e.prefill_selected_options()}))}},{key:"check_session",value:function(){var e=this;this.ss.getUserSessionObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){t._id||(e.ps.newMessage("error","Login Needed","Please login to perform this action"),e.router.navigate(["/"]))}))}},{key:"buttonEventFromParent",value:function(){var e=this;this.ps.checkSubmition().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){"save-next"==t?e.nextPage():e.nextNoSave()}))}},{key:"check_action",value:function(){}},{key:"prefill_selected_options",value:function(){var e=this;this.ps.AdObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){(null==t?void 0:t.country)&&e.prefill_country(t)}))}},{key:"prefill_country",value:function(e){var t=this.countries.find((function(t){return e.country==t.countryName}));this.selectedCountry=t?t._id:"",this.selectedCountryName=t?t.countryName:"",this.prefill_state(t,e)}},{key:"prefill_state",value:function(e,t){this.states=e?e.states:[],t.state&&(this.selectedState=t.state,this.prefill_city(t))}},{key:"prefill_city",value:function(e){var t=this;this.change_state(e.state).then((function(){t.ad.city&&(t.selectedCity=e.city,t.saved=!0)}))}},{key:"getAdData",value:function(e){var t=this;this.ps.get_ad(e).pipe(Object(c.a)(this.unsub$)).subscribe((function(e){e.status?t.ps.NewAdData(e.data):t.ps.newMessage("error","No Data",e.message)}),this.handle_error.bind(this))}},{key:"get_country",value:function(){var e=this;return new Promise((function(t,n){e.ds.get_countries().pipe(Object(c.a)(e.unsub$)).subscribe((function(i){return i.status?(e.countries=i.data,t(!0)):(e.ps.newMessage("error","Country Fetch Failed",i.message),n(!1))}),(function(t){return e.handle_error(t),n(!1)}))}))}},{key:"change_country",value:function(e){var t=this;this.selectedCountry=e;var n=this.countries.find((function(e){return e._id==t.selectedCountry}));this.states=n.states,this.selectedCountryName=n.countryName,this.selectedState=null,this.saved=!1}},{key:"change_state",value:function(e){var t=this;return this.saved=!1,this.loading=!0,this.selectedState=e,new Promise((function(e,n){return t.get_cities_from_server(e,n)}))}},{key:"get_cities_from_server",value:function(e,t){var n=this;this.ds.get_cities(this.selectedCountry,this.selectedState).pipe(Object(c.a)(this.unsub$)).subscribe((function(i){return n.loading=!1,i.status?(n.cities=i.data[0].cities,e(!0)):(n.ps.newMessage("error","Cities Fetch Failed",i.message),t(!1))}),(function(e){return n.handle_error(e),t(!1)}))}},{key:"change_city",value:function(e){this.saved=!1,this.selectedCity=e,this.nextPage()}},{key:"save_location",value:function(){var e=this;this.emptySelect()||(this.load(),this.ps.selectLocation(this.selectedCountry,this.selectedCountryName,this.selectedState,this.selectedCity).pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.stopload(),t.status?(e.ps.NewAdData(t.data),e.ps.newMessage("success","Ad Created","New Ad was created."),e.saved=!0,e.nextPage()):e.ps.newMessage("error","Couldn't Save",t.message)}),this.handle_error.bind(this)))}},{key:"update_location",value:function(){var e=this;this.emptySelect()||(this.load(),this.ps.updateLocation(this.selectedCountry,this.selectedCountryName,this.selectedState,this.selectedCity).pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.stopload(),t.status?(e.ps.NewAdData(t.data),e.ps.newMessage("success","Location Updated","Location was updated"),e.saved=!0,e.nextPage()):e.ps.newMessage("error","Couldn't Update",t.message)}),this.handle_error.bind(this)))}},{key:"handle_error",value:function(e){e.error instanceof ErrorEvent?this.ps.newMessage("error","Failed","couldn't connect to the url"):this.ps.newMessage("error","Failed",""+e.error.message),this.stopload()}},{key:"nextPage",value:function(){this.saved&&!this.UnsavedChangesExists()?this.router.navigate(["../ad-content"],{relativeTo:this.ar}):this.ad&&this.ad._id?this.update_location():this.save_location()}},{key:"nextNoSave",value:function(){"published"==this.ad.adState&&this.router.navigate(["../ad-content"],{relativeTo:this.ar})}},{key:"emptySelect",value:function(){if(""==this.selectedCountry)this.ps.newMessage("info","Country Not Selected","please Select a country");else if(""==this.selectedState)this.ps.newMessage("info","State Not Selected","Please select a state");else{if(""!=this.selectedCity)return!1;this.ps.newMessage("info","City Not Selected","Please select a city")}return!0}},{key:"UnsavedChangesExists",value:function(){return!(1!=this.saved||!(this.ad.country||this.ad.state||this.ad.city)||this.ad.country==this.selectedCountryName&&this.ad.state==this.selectedState&&this.ad.city==this.selectedCity||(this.ps.newMessage("info","Unsaved Changes","You have unsaved changes, discard them?"),0))}},{key:"ngOnDestroy",value:function(){this.unsub$.next(),this.unsub$.complete()}},{key:"load",value:function(){this.submitting=!0,this.loader.start()}},{key:"stopload",value:function(){this.submitting=!1,this.loader.stop()}}]),t}()).\u0275fac=function(e){return new(e||I)(l.Kb(A.a),l.Kb(u.a),l.Kb(o.f),l.Kb(d.a),l.Kb(o.a),l.Kb(b.a))},I.\u0275cmp=l.Eb({type:I,selectors:[["app-select-location"]],decls:26,vars:6,consts:[[1,"container"],[1,"row"],[1,"col-sm-12"],[1,"cat-select-list"],[1,"col-lg-4"],[1,"cat-select-list-des"],[1,"cat-select-head"],[1,"cat-seledt-link"],["class","yes-radio",4,"ngFor","ngForOf"],["class","loader-spinner",4,"ngIf"],[1,"yes-radio"],["type","radio","name","province","id","provines","data-provines","22","data-name","Alberta",3,"ngModel","value","ngModelChange","click"],["type","radio","name","region","id","regions","data-provines","22","data-name","Alberta",3,"value","ngModel","ngModelChange","click"],["type","radio","name","city","id","cities","data-provines","22","data-name","Alberta",3,"value","ngModel","ngModelChange","click"],[1,"loader-spinner"]],template:function(e,t){1&e&&(l.Qb(0,"div",0),l.Qb(1,"div",1),l.Qb(2,"div",2),l.Qb(3,"div",3),l.Qb(4,"div",0),l.Qb(5,"form"),l.Qb(6,"div",1),l.Qb(7,"div",4),l.Qb(8,"div",5),l.Qb(9,"h2",6),l.Jc(10," Select a Province "),l.Pb(),l.Qb(11,"div",7),l.Hc(12,T,4,3,"label",8),l.Pb(),l.Pb(),l.Pb(),l.Qb(13,"div",4),l.Qb(14,"div",5),l.Qb(15,"h2",6),l.Jc(16," Select a Region "),l.Pb(),l.Qb(17,"div",7),l.Hc(18,j,4,3,"label",8),l.Pb(),l.Pb(),l.Pb(),l.Qb(19,"div",4),l.Qb(20,"div",5),l.Qb(21,"h2",6),l.Jc(22," Select a City "),l.Pb(),l.Qb(23,"div",7),l.Hc(24,$,4,3,"label",8),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Hc(25,E,1,0,"div",9)),2&e&&(l.Cb("submitting",t.submitting),l.yb(12),l.ic("ngForOf",t.countries),l.yb(6),l.ic("ngForOf",t.states),l.yb(6),l.ic("ngForOf",t.cities),l.yb(1),l.ic("ngIf",t.loading))},directives:[h.A,h.o,h.p,a.m,a.n,h.u,h.c,h.n,h.q],styles:['.selector-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-evenly;align-items:center}.select[_ngcontent-%COMP%]{min-width:32%;flex:1;max-width:48%;height:60px;margin:5px 2px}[_nghost-%COMP%]     .p-dropdown{width:100%;height:100%;background:#f5f5f5}[_nghost-%COMP%]     .p-card{box-shadow:0 0 3px rgb(0 0 0/30%)}[_nghost-%COMP%]     .p-dropdown-label{display:flex;align-items:center}.page-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.submitting[_ngcontent-%COMP%]{position:relative}.submitting[_ngcontent-%COMP%]:before{content:" ";width:100%;height:100%;background:hsla(0,0%,100%,.6);position:absolute;top:0;left:0;z-index:1111}.error[_ngcontent-%COMP%]{color:red}.loader-spinner[_ngcontent-%COMP%]{border:10px solid #f3f3f3;border-top-color:#3498db;border-radius:50%;width:70px;height:70px;-webkit-animation:spin 1.5s linear infinite;animation:spin 1.5s linear infinite;z-index:1000;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}@-webkit-keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@media screen and (max-width:700px){.select[_ngcontent-%COMP%]{min-width:45%;max-width:unset}}@media screen and (max-width:500px){.select[_ngcontent-%COMP%]{width:100%}}']}),I),D=((z=function(){function t(n,i,s,a,o){e(this,t),this.router=n,this.ss=i,this.ar=s,this.ps=a,this.loader=o,this.submitting=!1,this.unsub$=new r.a}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.ps.newPage(7),this.buttonEventFromParent(),this.ps.AdObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.ad=t,e.ad._id||(alert("ad is not initialized"),e.router.navigate(["../select-location"],{relativeTo:e.ar}))})),this.ss.getUserSessionObservable().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){e.session=t}))}},{key:"buttonEventFromParent",value:function(){var e=this;this.ps.checkSubmition().pipe(Object(c.a)(this.unsub$)).subscribe((function(t){"save-next"==t?e.nextPage():"prev"==t?e.prevPage():e.nextNoSave()}))}},{key:"nextPage",value:function(){this.plan instanceof Object&&this.plan.planId&&this.plan._id?this.handle_upgrade():"published"==this.ad.adState?(this.ps.newMessage("success","Ad Saved","The ad was saved with all the changes"),this.router.navigate(["complete/"+this.ad._id],{relativeTo:this.ar})):this.publish()}},{key:"nextNoSave",value:function(){this.router.navigate([this.session.type+"/foodbank/edit/complete/"+this.ad._id],{})}},{key:"publish",value:function(){var e=this;this.load(),this.ps.publish_normal(this.ad._id).pipe(Object(c.a)(this.unsub$)).subscribe((function(t){t.status?(e.stopload(),e.router.navigate([e.session.type+"/foodbank/edit/complete/"+e.ad._id],{})):(e.stopload(),alert(t.message))}),this.errorHandle.bind(this))}},{key:"handle_upgrade",value:function(){this.router.navigate(["/receiver/post/pay-via-card"],{queryParams:{action:"upgrade"}})}},{key:"prevPage",value:function(){this.router.navigate(["../choose-grocery"],{relativeTo:this.ar})}},{key:"errorHandle",value:function(e){var t;e.error instanceof ErrorEvent?this.ps.newMessage("error","Error Occured","sorry some error occured"):this.ps.newMessage("error","Error Occured",null===(t=e.error)||void 0===t?void 0:t.message),this.stopload()}},{key:"load",value:function(){this.submitting=!0,this.loader.start()}},{key:"stopload",value:function(){this.submitting=!1,this.loader.stop()}},{key:"ngOnDestroy",value:function(){this.unsub$.next(),this.unsub$.complete()}}]),t}()).\u0275fac=function(e){return new(e||z)(l.Kb(o.f),l.Kb(b.a),l.Kb(o.a),l.Kb(u.a),l.Kb(d.a))},z.\u0275cmp=l.Eb({type:z,selectors:[["app-finalize"]],decls:34,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-sm-12"],[1,"delivery-form","ad-sub-cat"],[1,"cat-list"],[1,"ad-sub-list","new-lis-sub"],[1,"border-0"],["type","text","placeholder","Enter Order Id",1,"form-control"],[1,"row",2,"display","none"],[1,"col-lg-6"],[1,"price-sec"],[1,"fa","fa-angle-left"],[1,"price-btn","text-right"],[3,"click"],[1,"understand-sec","finalize-sec"],[1,"agree-head"],["href","#"]],template:function(e,t){1&e&&(l.Qb(0,"div",0),l.Qb(1,"div",1),l.Qb(2,"div",2),l.Qb(3,"form"),l.Qb(4,"div",3),l.Qb(5,"div",4),l.Qb(6,"div",5),l.Qb(7,"ul",6),l.Qb(8,"li"),l.Qb(9,"span"),l.Jc(10,"Order Id"),l.Pb(),l.Pb(),l.Qb(11,"li"),l.Lb(12,"input",7),l.Pb(),l.Pb(),l.Pb(),l.Qb(13,"div",8),l.Qb(14,"div",9),l.Qb(15,"div",10),l.Qb(16,"a"),l.Lb(17,"i",11),l.Pb(),l.Jc(18," All price are listed in "),l.Qb(19,"span"),l.Jc(20,"CAD"),l.Pb(),l.Pb(),l.Pb(),l.Qb(21,"div",9),l.Qb(22,"div",12),l.Qb(23,"a",13),l.Xb("click",(function(){return t.nextPage()})),l.Jc(24," Post Now "),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(25,"div",14),l.Qb(26,"div",0),l.Qb(27,"div",15),l.Qb(28,"h5"),l.Jc(29," Prices listed are in CAD "),l.Pb(),l.Qb(30,"p"),l.Jc(31," MyIssues charges wil read MyIssues services on your statement. Need help with payments?"),l.Qb(32,"a",16),l.Jc(33,"Contact Us"),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb())},directives:[h.A,h.o,h.p],styles:[""]}),z),H=s("RYz/"),U=[{path:"",component:J,children:[{path:"",redirectTo:"select-location",pathMatch:"full"},{path:"select-location",canActivate:[H.a],component:L,data:{moveToStep:2,isStartStep:!0}},{path:"ad-content",canActivate:[H.a],component:O,data:{moveToStep:3}},{path:"photos",canActivate:[H.a],loadChildren:function(){return s.e(49).then(s.bind(null,"35ha")).then((function(e){return e.PhotosModule}))},data:{moveToStep:8}},{path:"choose-grocery",canActivate:[H.a],component:N,data:{moveToStep:9}},{path:"finalize",canActivate:[H.a],component:D,data:{moveToStep:10}}]}],X=((F=function t(){e(this,t)}).\u0275mod=l.Ib({type:F}),F.\u0275inj=l.Hb({factory:function(e){return new(e||F)},imports:[[o.j.forChild(U)],o.j]}),F),R=s("qxW0"),q=s("Gxio"),B=s("FMpt"),G=((K=function t(){e(this,t)}).\u0275mod=l.Ib({type:K}),K.\u0275inj=l.Hb({factory:function(e){return new(e||K)},imports:[[a.b,X,h.j,R.a,p.b,g.b,q.b,B.a,R.a]]}),K)}}])}();